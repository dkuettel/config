#!/bin/zsh
set -eux -o pipefail

export vim_is_flip_flopping=yes
touch flip-flop.vim

while true; do

    # TODO one problem is we dont reuse the lsp now
    # could be an opportunity to try detached, and "project wide" pyright or other lsps?
    nvim -S flip-flop.vim

    # --maximized doesnt seem to do anything in dwm, not even when floating
    # neovide --nofork --multigrid --x11-wm-class neovide-flip-flop --maximized -- -S flip-flop.vim

    # let g:neovide_fullscreen = v:true -> a bit aggressive, like a modal window
    # note: floating rule on x11-wm-class prevents tiling flicker before anyway it goes fullscreen
    neovide --nofork --multigrid --x11-wm-class neovide-flip-flop -- -c 'let g:neovide_fullscreen = v:true' -S flip-flop.vim

    # just plain but with monocle -> nice to switch, but all tags use monocle then
    # neovide --nofork --multigrid -- -S flip-flop.vim

    # floating rules with --x11-wm-class neovide-flip-flop is not nice because floats stay on top always
    # neovide --nofork --multigrid --x11-wm-class neovide-flip-flop -- -S flip-flop.vim

done

# TODO use some temp and no collisions?
rm flip-flop.vim
